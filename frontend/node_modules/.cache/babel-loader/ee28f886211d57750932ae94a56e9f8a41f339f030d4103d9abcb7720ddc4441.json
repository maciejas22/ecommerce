{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maciej\\\\Desktop\\\\projekt_indywidualny\\\\shop\\\\frontend\\\\src\\\\context\\\\AuthProvider.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport default AuthContext;\nexport const AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  let [user, setUser] = useState(() => localStorage.getItem(\"authTokens\") ? jwt_decode(localStorage.getItem(\"authTokens\")) : null);\n  let [authTokens, setAuthTokens] = useState(() => localStorage.getItem(\"authTokens\") ? JSON.parse(localStorage.getItem(\"authTokens\")) : null);\n  let [loading, setLoading] = useState(false);\n  let registerUser = async e => {\n    e.preventDefault();\n    const respone = await fetch(\"http://localhost:8000/api/register/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        name: e.target.name.value,\n        surname: e.target.surname.value,\n        username: e.target.username.value,\n        email: e.target.email.value,\n        password: e.target.password.value,\n        password2: e.target.confirmPassword.value\n      })\n    });\n    const data = await respone.json();\n    if (Response.status === 201) {\n      console.log(\"User created\");\n    } else {\n      console.log(data);\n      alert(data);\n    }\n  };\n  let loginUser = async e => {\n    e.preventDefault();\n    const respone = await fetch(\"http://localhost:8000/api/token/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username: e.target.username.value,\n        password: e.target.password.value\n      })\n    });\n    const data = await respone.json();\n    if (Response.status === 200) {\n      setAuthTokens(data);\n      setUser(jwt_decode(data.access));\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\n    } else {\n      alert(\"Invalid credentials\");\n    }\n  };\n  let logoutUser = () => {\n    setAuthTokens(null);\n    setUser(null);\n    localStorage.removeItem(\"authTokens\");\n  };\n  let contextData = {\n    user: user,\n    authTokens: authTokens,\n    registerUser: registerUser,\n    loginUser: loginUser,\n    logoutUser: logoutUser\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: loading ? null : children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"AFtpneFGtsn+HTyEXVh4ZGw8Ro8=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","jwt_decode","jsxDEV","_jsxDEV","AuthContext","AuthProvider","_ref","_s","children","user","setUser","localStorage","getItem","authTokens","setAuthTokens","JSON","parse","loading","setLoading","registerUser","e","preventDefault","respone","fetch","method","headers","body","stringify","name","target","value","surname","username","email","password","password2","confirmPassword","data","json","Response","status","console","log","alert","loginUser","access","setItem","logoutUser","removeItem","contextData","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Maciej/Desktop/projekt_indywidualny/shop/frontend/src/context/AuthProvider.jsx"],"sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport default AuthContext;\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  let [user, setUser] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? jwt_decode(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n\r\n  let [authTokens, setAuthTokens] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? JSON.parse(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n  let [loading, setLoading] = useState(false);\r\n\r\n  let registerUser = async (e) => {\r\n    e.preventDefault();\r\n    const respone = await fetch(\"http://localhost:8000/api/register/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        name: e.target.name.value,\r\n        surname: e.target.surname.value,\r\n        username: e.target.username.value,\r\n        email: e.target.email.value,\r\n        password: e.target.password.value,\r\n        password2: e.target.confirmPassword.value,\r\n      }),\r\n    });\r\n    const data = await respone.json();\r\n\r\n    if (Response.status === 201) {\r\n      console.log(\"User created\");\r\n    } else {\r\n      console.log(data);\r\n      alert(data);\r\n    }\r\n  };\r\n\r\n  let loginUser = async (e) => {\r\n    e.preventDefault();\r\n    const respone = await fetch(\"http://localhost:8000/api/token/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        username: e.target.username.value,\r\n        password: e.target.password.value,\r\n      }),\r\n    });\r\n    const data = await respone.json();\r\n\r\n    if (Response.status === 200) {\r\n      setAuthTokens(data);\r\n      setUser(jwt_decode(data.access));\r\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\r\n    } else {\r\n      alert(\"Invalid credentials\");\r\n    }\r\n  };\r\n\r\n  let logoutUser = () => {\r\n    setAuthTokens(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"authTokens\");\r\n  };\r\n\r\n  let contextData = {\r\n    user: user,\r\n    authTokens: authTokens,\r\n\r\n    registerUser: registerUser,\r\n    loginUser: loginUser,\r\n    logoutUser: logoutUser,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={contextData}>\r\n      {loading ? null : children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}