{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maciej\\\\Desktop\\\\projekt_indywidualny\\\\shop\\\\frontend\\\\src\\\\context\\\\AuthProvider.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { redirect, useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport default AuthContext;\nexport const AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  let [user, setUser] = useState(() => localStorage.getItem(\"authTokens\") ? jwt_decode(localStorage.getItem(\"authTokens\")) : null);\n  let [authTokens, setAuthTokens] = useState(() => localStorage.getItem(\"authTokens\") ? JSON.parse(localStorage.getItem(\"authTokens\")) : null);\n  let [isloggedIn, setIsloggedIn] = useState(() => localStorage.getItem(\"authTokens\") ? true : false);\n  let [loading, setLoading] = useState(false);\n  let registerUser = async e => {\n    e.preventDefault();\n    const respone = await fetch(\"http://localhost:8000/api/register/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        name: e.target.name.value,\n        surname: e.target.surname.value,\n        username: e.target.username.value,\n        email: e.target.email.value,\n        password: e.target.password.value,\n        password2: e.target.confirmPassword.value\n      })\n    });\n    const data = await respone.json();\n    if (respone.status === 201) {\n      console.log(\"User created\");\n    } else {\n      console.log(data);\n      alert(data);\n    }\n  };\n  let loginUser = async e => {\n    e.preventDefault();\n    const respone = await fetch(\"http://localhost:8000/api/token/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username: e.target.username.value,\n        password: e.target.password.value\n      })\n    });\n    const data = await respone.json();\n    if (respone.status === 200) {\n      console.log(\"User logged in\");\n      setAuthTokens(data);\n      setUser(jwt_decode(data.access));\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\n    } else {\n      alert(\"Invalid credentials\");\n    }\n  };\n  const navigate = useNavigate();\n  let logoutUser = () => {\n    console.log(\"User logged out\");\n    setAuthTokens(null);\n    setUser(null);\n    localStorage.removeItem(\"authTokens\");\n    navigate(\"/\");\n    redirect(\"/\");\n  };\n  let contextData = {\n    isloggedIn: isloggedIn,\n    user: user,\n    authTokens: authTokens,\n    registerUser: registerUser,\n    loginUser: loginUser,\n    logoutUser: logoutUser\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: loading ? null : children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"DiPZGuQdQt8m+nIeL6h27NklL/I=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","jwt_decode","redirect","useNavigate","jsxDEV","_jsxDEV","AuthContext","AuthProvider","_ref","_s","children","user","setUser","localStorage","getItem","authTokens","setAuthTokens","JSON","parse","isloggedIn","setIsloggedIn","loading","setLoading","registerUser","e","preventDefault","respone","fetch","method","headers","body","stringify","name","target","value","surname","username","email","password","password2","confirmPassword","data","json","status","console","log","alert","loginUser","access","setItem","navigate","logoutUser","removeItem","contextData","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Maciej/Desktop/projekt_indywidualny/shop/frontend/src/context/AuthProvider.jsx"],"sourcesContent":["import { createContext, useState, useEffect } from \"react\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport { redirect, useNavigate } from \"react-router-dom\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport default AuthContext;\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  let [user, setUser] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? jwt_decode(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n\r\n  let [authTokens, setAuthTokens] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? JSON.parse(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n  let [isloggedIn, setIsloggedIn] = useState(() =>\r\n    localStorage.getItem(\"authTokens\") ? true : false\r\n  );\r\n  let [loading, setLoading] = useState(false);\r\n\r\n  let registerUser = async (e) => {\r\n    e.preventDefault();\r\n    const respone = await fetch(\"http://localhost:8000/api/register/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        name: e.target.name.value,\r\n        surname: e.target.surname.value,\r\n        username: e.target.username.value,\r\n        email: e.target.email.value,\r\n        password: e.target.password.value,\r\n        password2: e.target.confirmPassword.value,\r\n      }),\r\n    });\r\n    const data = await respone.json();\r\n\r\n    if (respone.status === 201) {\r\n      console.log(\"User created\");\r\n    } else {\r\n      console.log(data);\r\n      alert(data);\r\n    }\r\n  };\r\n\r\n  let loginUser = async (e) => {\r\n    e.preventDefault();\r\n    const respone = await fetch(\"http://localhost:8000/api/token/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        username: e.target.username.value,\r\n        password: e.target.password.value,\r\n      }),\r\n    });\r\n    const data = await respone.json();\r\n\r\n    if (respone.status === 200) {\r\n      console.log(\"User logged in\");\r\n      setAuthTokens(data);\r\n      setUser(jwt_decode(data.access));\r\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\r\n    } else {\r\n      alert(\"Invalid credentials\");\r\n    }\r\n  };\r\n  const navigate = useNavigate();\r\n  let logoutUser = () => {\r\n    console.log(\"User logged out\");\r\n    setAuthTokens(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"authTokens\");\r\n    navigate(\"/\");\r\n    redirect(\"/\");\r\n  };\r\n\r\n  let contextData = {\r\n    isloggedIn: isloggedIn,\r\n    user: user,\r\n    authTokens: authTokens,\r\n\r\n    registerUser: registerUser,\r\n    loginUser: loginUser,\r\n    logoutUser: logoutUser,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={contextData}>\r\n      {loading ? null : children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}